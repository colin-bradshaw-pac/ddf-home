name: Update Catalog Run

on:
  issues:
    types: [opened]

env:
  GITHUB_CONTEXT: ${{ toJson(github) }}

jobs:
  update-catalog:
    name: Update Catalog
    runs-on: ubuntu-latest
    steps:
    - name: Check-out python repository
      uses: actions/checkout@v4
      with:
        repository: colin-bradshaw-pac/ddf-home-testing
        sparse-checkout: |
          catalog
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: Check root file system
      run: |
        ls ${{ github.workspace }}

    - name: check catalog
      run: |
        ls ${{ github.workspace }}/catalog

    - name: Run add_row
      run: python ${{ github.workspace }}/catalog/add_row.py '${{ env.GITHUB_CONTEXT }}'
      shell: sh

    - name: commit and push changes
      run: |
        git add --all
        git commit -m "generated"
        git push